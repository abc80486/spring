<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" style="height: 100%;">
<head>
  <meta charset="utf-8">
  <title>东莞格力群控系统</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="" name="keywords">
  <meta content="" name="description">
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">
  <link href="https://fonts.googleapis.com/css?family=Ruda:400,900,700" rel="stylesheet">
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="lib/prettyphoto/css/prettyphoto.css" rel="stylesheet">
  <link href="lib/hover/hoverex-all.css" rel="stylesheet">
  <link href="lib/jetmenu/jetmenu.css" rel="stylesheet">
  <link href="lib/owl-carousel/owl-carousel.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="css/colors/blue.css">
  <link rel="stylesheet" href="css/mui.min.css">
</head>
<body>
    <header class="header" style="margin: 0;">
    <div class="container" style="margin: 0;" >
        <div class="site-header clearfix"></div>
        <div class="col-lg-3 col-md-3 col-sm-12 title-area">
            <div class="site-title" id="title">
            <a href="index.html" title="">
                <h4>东莞格力</br><span>中央空调群控系统</span></h4>
            </a>
            </div>
        </div>
        <div class="col-lg-9 col-md-12 col-sm-12">
            <div id="nav" class="right">
            <div class="container clearfix">
                <ul id="jetmenu" class="jetmenu blue">
                <li><a href="/index">监控中心</a>
                </li>
                <li class="active"><a href="/TrendAnalysis">趋势分析</a>
                </li>
                <li><a href="#">能耗统计</a>
                </li>
                <li><a href="#">异常报警</a>
                </li>
                <li><a href="#" th:text="${pr}">定时设置</a>
                </li>
                </ul>
            </div>
            </div>
        </div>
        </div>
    </div>
    </header>
    <div style="position: relative;left:15px;top:10px;height: 560px;width:1260px;border:rgb(152, 161, 161) solid 2px;">
        <div  style="position: absolute;left:15px;top:10px;border:rgb(152, 161, 161) solid 2px;height: 250px;width: 910px;">
            <span style="font-size: 5px;margin-left: 12px;">设备运行时间统计</span>
            <div id="dayRuntime" style="position: absolute;left:15px;top:30px;height: 200px;width:280px;border:rgb(152, 161, 161) solid 2px;"></div>    
            <div id="weekRuntime" style="position: absolute;left:310px;top:30px;height: 200px;width:280px;border:rgb(152, 161, 161) solid 2px;"></div>    
            <div id="monthRuntime" style="position: absolute;left:605px;top:30px;height: 200px;width:280px;border:rgb(152, 161, 161) solid 2px;"></div>    
        </div>

        <div  style="position:absolute;left:940px;top:10px;border:rgb(152, 161, 161) solid 2px;height: 250px;width: 300px;">
            <span style="font-size: 5px;margin-left: 12px;">设备在线数量</span>
            <div id="equipmentNum" style="position: absolute;left:15px;top:30px;height: 200px;width:270px;border:rgb(152, 161, 161) solid 2px;"></div>    
        </div>

        <div  style="position: absolute;left:15px;top:280px;border:rgb(152, 161, 161) solid 2px;height: 250px;width: 1225px;">
            <span style="font-size: 5px;margin-left: 12px;">供水管道数据检测</span>
            <div id="tube1" style="position: absolute;left:15px;top:30px;height: 200px;width:575px;border:rgb(152, 161, 161) solid 2px;"></div>    
           <!--- <div id="tube2" style="position: absolute;left:310px;top:30px;height: 200px;width:280px;border:rgb(152, 161, 161) solid 2px;"></div>    
            --> <div id="tube3" style="position: absolute;left:605px;top:30px;height: 200px;width:575px;border:rgb(152, 161, 161) solid 2px;"></div>    
        </div>
    </div>
    <script src="lib/jquery/jquery.min.js"></script>
    <script src="js/echarts-all.js"></script>

    <script src="js/day.js"></script>
    <script src="js/week.js"></script>
    <script src="js/month.js"></script>
    <script src="js/EquipOnLine.js"></script>
    <script> 
        dayRuntimeFunc("dayRuntime");
        weekRuntimeFunc("weekRuntime");
        monthRuntimeFunc("monthRuntime");
        EquipmentOnLine("equipmentNum"); 
    </script>

    <script>
        var pre1 =  [];
        var pre2 =  [];
        var tem1 = [];
        var tem2 =  [];
        var xaxis = [];

        var tag = 0;
        var num = 0;
        var data;
        setInterval(function(){
        $.ajax({
            url : "/getData",
            type : 'GET',
            dataType: "json",
            //success : function(data){
            success : function(d){data = d;}
        });
        if(tag==0){
            var i=0;
            for(;i<10;i++){
                pre1.push(data[17]);
                pre2.push(data[18]);
                tem1.push(data[19]/10.0);
                tem2.push(data[20]/10.0);
                xaxis.push(new Date().toLocaleTimeString());
            }
            tag=1;
        }
        pre1.shift();
        pre2.shift();
        tem1.shift();
        tem2.shift();
        xaxis.shift();
        pre1.push(data[17]);
        pre2.push(data[18]);
        tem1.push(data[19]/10.0);
        tem2.push(data[20]/10.0);
        xaxis.push(new Date().toLocaleTimeString());
            //alert(pre1);
        //document.getElementById("tube1").innerHTML = pre1;
        //document.getElementById("tube2").innerHTML = pre2;
        //document.getElementById("tube3").innerHTML = tem1;
        //document.getElementById("tube4").innerHTML = tem2;

        function cjj(id){
			var dom = document.getElementById(id);
			var myChart = echarts.init(dom);
			var app = {};
			var option = null;
			option = {
				tooltip: {
                    trigger: 'axis',
                },
                grid: {
                    x: 30,y: 30,x2:32,y2:30,
                    containLabel: true
                },

				legend: {
					data:['供水温度', '回水温度']
				},
				toolbox: {
					show: true,
					feature: {
						dataView: {readOnly: false},
						restore: {},
						saveAsImage: {}
					}
				},
				dataZoom: {
					show: false,
					start: 0,
					end: 100
				},
				xAxis: [
					{
						type: 'category',
						boundaryGap: true,
						data: (function (){
							var now = new Date();
							var res = [];
							var len = 10;
							while (len--) {
								res.unshift(now.toLocaleTimeString().replace(/^\D*/,''));
								now = new Date(now - 2000);
							}
							return res;
						})()
					},
				],
				yAxis: [
					{
						type: 'value',
						scale: true,
						name: '摄氏度',
						max: 50,
						min: 0,
						boundaryGap: [0.2, 0.2]
					}
				  
				],
				series: [
					{
						name:'供水温度',
						type:'line',
                        data:tem1,
                        label: {
                                normal: {
                                    show: true,
                                    position: 'top'
                                }
                        },                    

					},
					{
						name:'回水温度',
						type:'line',
						data:tem2,
					}
				]
			};
			app.count = 11;
            if (option && typeof option === "object") {
				myChart.setOption(option, true);
			}
		};
        cjj("tube1");
    },5*1000);
    </script>



</body>
</html>