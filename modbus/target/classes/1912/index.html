<!DOCTYPE html>
<html lang="en" style="height: 100%;" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <title>东莞格力群控系统</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="" name="keywords">
  <meta content="" name="description">

  <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Ruda:400,900,700" rel="stylesheet">

  <!-- Bootstrap CSS File -->
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Libraries CSS Files -->
  <link href="lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="lib/prettyphoto/css/prettyphoto.css" rel="stylesheet">
  <link href="lib/hover/hoverex-all.css" rel="stylesheet">
  <link href="lib/jetmenu/jetmenu.css" rel="stylesheet">
  <link href="lib/owl-carousel/owl-carousel.css" rel="stylesheet">

  <!-- Main Stylesheet File -->
  <link href="css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="css/colors/blue.css">

  <!-- mui -->
  <link rel="stylesheet" href="css/mui.min.css">
 

</head>

>
  
  <!-- end topbar -->

  <header class="header" style="margin: 0;">
    <div class="container" style="margin: 0;" >
      <div class="site-header clearfix">
        <div class="col-lg-3 col-md-3 col-sm-12 title-area">
          <div class="site-title" id="title">
            <a href="index.html" title="">
              <h4>东莞格力</br><span>中央空调群控系统</span></h4>
            </a>
          </div>
        </div>
        <!-- title area -->
        <div class="col-lg-9 col-md-12 col-sm-12">
          <div id="nav" class="right">
            <div class="container clearfix">
              <ul id="jetmenu" class="jetmenu blue">
                <li class="active"><a href="index.html">监控中心</a>
                </li>
                <li><a href="#">趋势分析</a>
                </li>
                <li><a href="#">能耗统计</a>
                </li>
                <li><a href="#">异常报警</a>
                </li>
                <li><a href="#">定时设置</a>
                </li>
              </ul>
            </div>
          </div>
          <!-- nav -->
        </div>
        <!-- title area -->
      </div>
      <!-- site header -->
    </div>
    <!-- end container -->
  </header>
  <!-- end header -->
  <div style="position: relative;">
    <img src="img/main5.jpg" alt="" class="img-responsive">  
    <div style="position: absolute;top:0%;right: 10px;">
      <div class="mui-content-padded" style="width: 250px;">
        <h6>组合式空调</h6>
        <ul class="mui-table-view" style="font-size: 6px;">
              <li class="mui-table-view-cell" style="height: 30px;">
                启停控制
                <div id="air_conditioner" class="mui-switch mui-switch-blue mui-switch-mini"style="height: 60%;">
                  <div class="mui-switch-handle" style="height: 100%;"></div>
                </div>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">
                控制方式&nbsp;&nbsp;
                <input name="radio1" type="radio"><label>制冷</label>
                <input name="radio1" type="radio"><label>制热</label>
                <input name="radio1" type="radio"><label>自动</label>
                <input name="radio1" type="radio"><label>副热</label>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">机组运行状态<span class="mui-badge mui-badge-inverted" id="spindle_speed">停止</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">回风温度(°C)<span class="mui-badge mui-badge-inverted" id="system_error_code">20.5</li>
              <li class="mui-table-view-cell"style="height: 30px;">送风温度(°C)<span class="mui-badge mui-badge-inverted" id="spindle_current">20.0</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">回风温度(%)<span class="mui-badge mui-badge-inverted" id="tool_in_use">60</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">送风湿度(%)<span class="mui-badge mui-badge-inverted" id="tool_number">60</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">机组控制方式<span class="mui-badge mui-badge-inverted" id="tool_life">远程</span></li>
        </ul>
      </div>
    </div>

    <div style="position: absolute;top:270px;right: 10px;">
      <div class="mui-content-padded" style="width: 250px;">
        <h6></h6>

        <ul class="mui-table-view" style="font-size: 6px;">
              <li class="mui-table-view-cell" style="height: 30px;">
                供冷回水温度(℃)<span class="mui-badge mui-badge-inverted"><input id="temp1" type="text"  placeholder="40.0" style="width: 70px;height: 20px;margin: auto -10px;"></span>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">
                制热回水温度(℃)<span class="mui-badge mui-badge-inverted"><input id="temp2"type="text"  placeholder="15.0" style="width: 70px;height: 20px;margin: auto -10px;"></span>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">
                水泵关闭延时(s)<span class="mui-badge mui-badge-inverted"><input id="temp3"type="text"  placeholder="1.0" style="width: 70px;height: 20px;margin: auto -10px;"></span>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">
                水泵开启延时(s)<span class="mui-badge mui-badge-inverted"><input id="temp4"type="text"  placeholder="1.0" style="width: 70px;height: 20px;margin: auto -10px;"></span>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">
                机组开启延时(s)<span class="mui-badge mui-badge-inverted"><input id="hum" type="text"  placeholder="1.0" style="width: 70px;height: 20px;margin: auto -10px;"></span>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">
                阀门开启延时(s)<span class="mui-badge mui-badge-inverted"><input id="valv" type="text"  placeholder="1.0" style="width: 70px;height: 20px;margin: auto -10px;"></span>
              </li>
        </ul>
      </div>
    </div>

    <div style="position: absolute;bottom:20px;left: 270px;">
      <div class="mui-content-padded" style="width: 200px;float:left;">
        <h6>1#水泵电机</h6>
        <ul class="mui-table-view" style="font-size: 6px;">
              <li class="mui-table-view-cell" style="height: 30px;">
                启停控制
                <div id="wp1" class="mui-switch mui-switch-blue mui-switch-mini"style="height: 60%;">
                  <div class="mui-switch-handle" style="height: 100%;"></div>
                </div>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">运行状态<span class="mui-badge mui-badge-inverted" id="wp1_status">停止</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">本地/远程<span class="mui-badge mui-badge-inverted" id="wp1_mode">远程</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">耗电功率（W）<span class="mui-badge mui-badge-inverted" id="system_error_code">20.5</li>
        </ul>
      </div>
      <div class="mui-content-padded" style="width: 200px;float:left;">
        <h6>2#水泵电机</h6>
        <ul class="mui-table-view" style="font-size: 6px;">
              <li class="mui-table-view-cell" style="height: 30px;">
                启停控制
                <div id="wp2" class="mui-switch mui-switch-blue mui-switch-mini"style="height: 60%;">
                  <div class="mui-switch-handle" style="height: 100%;"></div>
                </div>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">运行状态<span class="mui-badge mui-badge-inverted" id="wp2_status">停止</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">本地/远程<span class="mui-badge mui-badge-inverted" id="wp2_mode">远程</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">耗电功率（W）<span class="mui-badge mui-badge-inverted" id="system_error_code">20.5</li>
        </ul>
      </div>
      <div class="mui-content-padded" style="width: 200px;float:left;">
        <h6>3#水泵电机</h6>
        <ul class="mui-table-view" style="font-size: 6px;">
              <li class="mui-table-view-cell" style="height: 30px;">
                启停控制
                <div id="wp3" class="mui-switch mui-switch-blue mui-switch-mini"style="height: 60%;">
                  <div class="mui-switch-handle" style="height: 100%;"></div>
                </div>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">运行状态<span class="mui-badge mui-badge-inverted" id="wp3_status">停止</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">本地/远程<span class="mui-badge mui-badge-inverted" id="wp3_mode">远程</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">耗电功率（W）<span class="mui-badge mui-badge-inverted" id="system_error_code">20.5</li>
        </ul>
      </div>
    </div>

    <div style="position: absolute;top:0%;left: 10px;">
      <div class="mui-content-padded" style="width: 150px;">
        <h6>1#机组</h6>
        <ul class="mui-table-view" style="font-size: 6px;">
              <li class="mui-table-view-cell" style="height: 30px;">
                启停控制
                <div id="crew1" class="mui-switch mui-switch-blue mui-switch-mini"style="height: 60%;">
                  <div class="mui-switch-handle" style="height: 100%;"></div>
                </div>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">机组运行状态<span class="mui-badge mui-badge-inverted" id="spindle_speed">停止</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">出水温度(°C)<span class="mui-badge mui-badge-inverted" id="system_error_code">20.5</li>
              <li class="mui-table-view-cell"style="height: 30px;">进水温度(°C)<span class="mui-badge mui-badge-inverted" id="spindle_current">20.0</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">耗电功率（W）<span class="mui-badge mui-badge-inverted" id="system_error_code">20.5</li>
        </ul>
      </div>
    </div>

    <div style="position: absolute;top:0%;left: 170px;">
        <div class="mui-content-padded" style="width: 150px;">
          <h6>1#蝶阀</h6>
          <ul class="mui-table-view" style="font-size: 6px;">
                <li class="mui-table-view-cell" style="height: 30px;">
                  启停控制
                  <div id="valve1" class="mui-switch mui-switch-blue mui-switch-mini"style="height: 60%;">
                    <div class="mui-switch-handle" style="height: 100%;"></div>
                  </div>
                </li>
                <li class="mui-table-view-cell" style="height: 30px;">蝶阀状态<span class="mui-badge mui-badge-inverted" id="valve1_status">停止</span></li>
                <li class="mui-table-view-cell"style="height: 30px;">控制方式<span class="mui-badge mui-badge-inverted" id="valve1_mode">远程</span></li>
          </ul>
        </div>
    </div>

    <div style="position: absolute;top:200px;left: 10px;">
      <div class="mui-content-padded" style="width: 150px;">
        <h6>2#机组</h6>
        <ul class="mui-table-view" style="font-size: 6px;">
              <li class="mui-table-view-cell" style="height: 30px;">
                启停控制
                <div id="crew2" class="mui-switch mui-switch-blue mui-switch-mini"style="height: 60%;">
                  <div class="mui-switch-handle" style="height: 100%;"></div>
                </div>
              </li>
              <li class="mui-table-view-cell" style="height: 30px;">机组运行状态<span class="mui-badge mui-badge-inverted" id="spindle_speed">停止</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">出水温度(°C)<span class="mui-badge mui-badge-inverted" id="system_error_code">20.5</li>
              <li class="mui-table-view-cell"style="height: 30px;">进水温度(°C)<span class="mui-badge mui-badge-inverted" id="spindle_current">20.0</span></li>
              <li class="mui-table-view-cell"style="height: 30px;">耗电功率（W）<span class="mui-badge mui-badge-inverted" id="system_error_code">20.5</li>
        </ul>
      </div>
    </div>

    <div style="position: absolute;top:200px;left: 170px;">
        <div class="mui-content-padded" style="width: 150px;">
          <h6>2#蝶阀</h6>
          <ul class="mui-table-view" style="font-size: 6px;">
                <li class="mui-table-view-cell" style="height: 30px;">
                  启停控制
                  <div id="valve2" class="mui-switch mui-switch-blue mui-switch-mini"style="height: 60%;">
                    <div class="mui-switch-handle" style="height: 100%;"></div>
                  </div>
                </li>
                <li class="mui-table-view-cell" style="height: 30px;">蝶阀状态<span class="mui-badge mui-badge-inverted" id="valve2_status">停止</span></li>
                <li class="mui-table-view-cell"style="height: 30px;">控制方式<span class="mui-badge mui-badge-inverted" id="valve2_mode">远程</span></li>
          </ul>
        </div>
    </div>

    <div style="position: absolute;top:400px;left: 10px;">
      <div class="mui-content-padded" style="width: 250px;">
        <h6>其他</h6>
        <ul class="mui-table-view" style="font-size: 6px;">
            <li class="mui-table-view-cell"style="height: 30px;">冷冻总管供水温度(°C)<span class="mui-badge mui-badge-inverted" id="tube1">20.5</li>
            <li class="mui-table-view-cell"style="height: 30px;">冷冻总管回水温度(°C)<span class="mui-badge mui-badge-inverted" id="tube2">20.0</span></li>
            <li class="mui-table-view-cell"style="height: 30px;">冷冻总管供水压力(Pa)<span class="mui-badge mui-badge-inverted" id="tube3">26728</span></li>
            <li class="mui-table-view-cell"style="height: 30px;">冷冻总管回水压力(Pa)<span class="mui-badge mui-badge-inverted" id="tube4">25028</span></li>
            <li class="mui-table-view-cell"style="height: 30px;">冷冻总管回水瞬时流量(m³)<span class="mui-badge mui-badge-inverted" id="tube5">0.0</span></li>
        </ul>
      </div>
    </div>

  </div>
  <footer class="footer">
    <div class="copyrights">
      <div class="container">
        <div class="col-lg-6 col-md-6 col-sm-12 columns footer-left">
          <p>Copyright ©GREE 2019 - 2019 All rights reserved.</p>
        </div>
        <!-- end widget -->
        <div class="col-lg-6 col-md-6 col-sm-12 columns text-right">
          <div class="footer-menu right">
            <ul class="menu">
              <li><a href="index.html">监控中心</a></li>
              <li><a href="about.html">趋势分析</a></li>
              <li><a href="#">能耗统计</a></li>
              <li><a href="#">异常报警</a></li>
              <li><a href="contact">定时设置</a></li>
            </ul>
          </div>
        </div>
        <!-- end large-6 -->
      </div>
      <!-- end container -->
    </div>
    <!-- end copyrights -->
  </footer>
  <!-- end footer -->
  <div class="dmtop">Scroll to Top</div>
  <script src="js/mui.min.js"></script>
  <!-- JavaScript Libraries -->
  <script src="lib/jquery/jquery.min.js"></script>
  <script src="lib/bootstrap/js/bootstrap.min.js"></script>
  <script src="lib/php-mail-form/validate.js"></script>
  <script src="lib/prettyphoto/js/prettyphoto.js"></script>
  <script src="lib/isotope/isotope.min.js"></script>
  <script src="lib/hover/hoverdir.js"></script>
  <script src="lib/hover/hoverex.min.js"></script>
  <script src="lib/unveil-effects/unveil-effects.js"></script>
  <script src="lib/owl-carousel/owl-carousel.js"></script>
  <script src="lib/jetmenu/jetmenu.js"></script>
  <script src="lib/animate-enhanced/animate-enhanced.min.js"></script>
  <script src="lib/jigowatt/jigowatt.js"></script>
  <script src="lib/easypiechart/easypiechart.min.js"></script>

  <!-- Template Main Javascript File -->
  <script src="js/main.js"></script>  
  <script>
    //mui("#wp1").switch().toggle();
    var wp1 = document.getElementById("wp1").classList;
    var wp1_status = document.getElementById("wp1_status");
    var wp1_mode = document.getElementById("wp1_mode");

    var wp2 = document.getElementById("wp2").classList;
    var wp2_status = document.getElementById("wp2_status");
    var wp2_mode = document.getElementById("wp2_mode");

    var wp3 = document.getElementById("wp3").classList;
    var wp3_status = document.getElementById("wp3_status");
    var wp3_mode = document.getElementById("wp3_mode");

    var valve1 = document.getElementById("valve1").classList;
    var valve1_status = document.getElementById("valve1_status");
    var valve1_mode = document.getElementById("valve1_mode");

    var valve2 = document.getElementById("valve2").classList;
    var valve2_status = document.getElementById("valve2_status");
    var valve2_mode = document.getElementById("valve2_mode");

    var data;
    setInterval(function(){
      $.ajax({
        url : "/getData",
        type : 'GET',
        dataType: "json",
        //success : function(data){
        success : function(d){data = d;}});
          //alert(data[2]);
         // data[1]==false?wp1.remove("mui-active"):wp1.add("mui-active");//controller
          if(data[1] ^ wp1.contains("mui-active")){
            mui("#wp1").switch().toggle();
          }
          //if(data[1]==true) mui("#wp1").switch();
          data[1]==false?wp1_status.innerHTML="已停止":wp1_status.innerHTML="运行中";//controller status
          data[2]==false?wp1_mode.innerHTML="手动":wp1_mode.innerHTML="远程";//controller mode
          //if(data[2]==false) wp1_mode.innerHTML="手动";
          //else wp1_mode.innerHTML="远程";
          if(data[4] ^ wp2.contains("mui-active"))  mui("#wp2").switch().toggle();
          data[4]==false?wp2_status.innerHTML="已停止":wp2_status.innerHTML="运行中";//controller status
          data[5]==false?wp2_mode.innerHTML="手动":wp2_mode.innerHTML="远程";//controller mode

          if(data[7] ^ wp3.contains("mui-active"))  mui("#wp3").switch().toggle();
          data[7]==false?wp3_status.innerHTML="已停止":wp3_status.innerHTML="运行中";//controller status
          data[8]==false?wp3_mode.innerHTML="手动":wp3_mode.innerHTML="远程";//controller mode

          if(data[10] ^ valve1.contains("mui-active"))  mui("#valve1").switch().toggle();
          if(data[10]==true) valve1_status.innerHTML="开到位";//controller status
          if(data[11]==true) valve1_status.innerHTML="关到位";//controller mode
          if(data[10]==false && data[11]==false) valve1_status.innerHTML = "切换中..."
          data[12]==false?valve1_mode.innerHTML="手动":valve1_mode.innerHTML="远程";

          if(data[14] ^ valve2.contains("mui-active"))  mui("#valve2").switch().toggle();
          if(data[14]==true) valve2_status.innerHTML="开到位";//controller status
          if(data[15]==true) valve2_status.innerHTML="关到位";//controller mode
          if(data[14]==false && data[15]==false) valve2_status.innerHTML = "切换中..."
          data[16]==false?valve2_mode.innerHTML="手动":valve2_mode.innerHTML="远程";

          document.getElementById("tube3").innerHTML = data[17];
          document.getElementById("tube4").innerHTML = data[18];
          document.getElementById("tube1").innerHTML = data[19]/10.0;
          document.getElementById("tube2").innerHTML = data[20]/10.0;
          document.getElementById("tube5").innerHTML = data[21];

          document.getElementById("temp1").value = data[23];
          document.getElementById("temp2").value = data[24];
          document.getElementById("temp3").value = data[25];
          document.getElementById("temp4").value = data[26];
          document.getElementById("hum").value = data[27];
          document.getElementById("valv").value = data[28];

       // },
      //})
    },600);
    function coil_ctrl(id,addr){
      document.getElementById(id).addEventListener("toggle",function(event){
        var statu;
        if(event.detail.isActive){
            statu = true;
        }else{
          statu = false;
        }
          $.ajax({
              url :  "/coil_ctrl",
              type : 'POST',
              data : {
                addr:addr,status:statu
              },
              success : function(data) {
                  //alert(data);
              },
              error : function(msg) {
                //alert(msg);
                alert(JSON.stringify(msg));
              }
          });
        
      });
    };
    //if(data[2]==true)
    if(data[2]==true)
    coil_ctrl("wp1",5-1);//1号电机1号手动自动，2状态，5号控制
    //else alert("手动模式下不允许操作，请设置为自动模式.")
    //alert(wp1_mode.innerHTML);
    if(data[5]==true)
    coil_ctrl("wp2",86-1);//2号电机7手动自动，8号状态，86控制
    if(data[8]==true)
    coil_ctrl("wp3",75-1);//3号电机71手动自动，72状态，75控制
   // coil_ctrl("air_conditioner",4);//组合式空调
    //coil_ctrl("crew1",5);//1号机组
    //coil_ctrl("crew2",6);//2号机组
    if(data[12]==true)
    coil_ctrl("valve1",82-1);//1号蝶阀78手动自动，79开到位，80关到位，82控制
    if(data[16]==true)
    coil_ctrl("valve2",29-1);//2号蝶阀25手动自动，26开到位，27关到位，29控制

    //coil_ctrl("valve2",1-1);//1手动自动
    function registerCtrl(id,adr){
      var temp = document.getElementById(id);
      temp.addEventListener("change",function(){
        dataTemp = temp.value;
        $.ajax({
              url :  "/registerCtrl",
              type : 'POST',
              data : {
                addr:adr,data:dataTemp
              }
          });  
      });
    };
    registerCtrl("temp1",16);
    registerCtrl("temp2",15);
    registerCtrl("temp3",12);
    registerCtrl("temp4",14);
    registerCtrl("hum",13);
    registerCtrl("valv",11);
    //04供水压力 05回水压力 06供水温度 07回水温度 17瞬时流量 18回水总流量
    //供冷回水温度设置16，制热回水温度15，水泵延迟关闭时间12，水泵延迟开启时间14，机组延迟开启时间13，阀门延迟关闭时间11
</script>


</body>
</html>
